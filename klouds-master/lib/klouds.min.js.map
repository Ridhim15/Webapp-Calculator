{"version":3,"sources":["webpack://klouds/webpack/universalModuleDefinition","webpack://klouds/webpack/bootstrap","webpack://klouds/./src/index.ts","webpack://klouds/./src/shader.vert","webpack://klouds/./src/shader.frag","webpack://klouds/./src/graphics.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Klouds","VERSION","shader_vert_1","shader_frag_1","graphics_1","parseColor","color","result","div","document","createElement","style","display","body","appendChild","numColors","getComputedStyle","match","intColors","map","a","parseInt","parentElement","removeChild","length","normalizeColor","forEach","idx","Array","isArray","slice","options","_this","this","isRunning","accumTime","lastTime","performance","now","render","time","gl","program","buffer","dt","speed","resizeCanvasToDisplaySize","canvas","viewport","width","height","useProgram","handle","bindBuffer","ARRAY_BUFFER","posAttrib","attributes","enableVertexAttribArray","vertexAttribPointer","FLOAT","uniform2f","uniforms","uniform1f","layerCount","uniform3fv","bgColor","cloudColor1","cloudColor2","drawArrays","TRIANGLES","requestAnimationFrame","queryRootElement","selector","Error","initGraphics","setSpeed","setLayerCount","setBgColor","setCloudColor1","setCloudColor2","start","element","querySelector","HTMLCanvasElement","console","error","HTMLElement","createContext","createProgram","createBuffer","deleteProgram","bufferData","Float32Array","reduce","prev","cur","concat","STATIC_DRAW","stop","Math","max","min","count","getSpeed","getLayerCount","getBgColor","getCloudColor1","getCloudColor2","jQuery","fn","elements","skies","push","ShaderType","createShader","type","source","shader","VERTEX","VERTEX_SHADER","FRAGMENT_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","debug","getShaderInfoLog","deleteShader","getContext","vertShaderSrc","fragShaderSrc","attributeNames","uniformNames","vertexShader","fragmentShader","FRAGMENT","attachShader","linkProgram","validateProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","VALIDATE_STATUS","name_1","attr","getAttribLocation","name_2","uniform","getUniformLocation","clientWidth","clientHeight"],"mappings":"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","file":"klouds.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"klouds\"] = factory();\n\telse\n\t\troot[\"klouds\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","\"use strict\";\nexports.__esModule = true;\nexports.create = exports.Klouds = exports.VERSION = void 0;\nvar shader_vert_1 = require(\"./shader.vert\");\nvar shader_frag_1 = require(\"./shader.frag\");\nvar graphics_1 = require(\"./graphics\");\nexports.VERSION = PACKAGE_VERSION;\nfunction normalizeColor(color) {\n    var div = document.createElement('div');\n    div.style.display = 'none';\n    div.style.color = color;\n    document.body.appendChild(div);\n    var strColors = getComputedStyle(div).color || 'rgb(0, 0, 0)';\n    var numColors = strColors.match(/[+-]?\\d+(\\.\\d+)?/g);\n    var intColors = numColors\n        ? numColors.map(function (a) { return parseInt(a, 10); })\n        : [0, 0, 0];\n    if (div.parentElement) {\n        div.parentElement.removeChild(div);\n    }\n    if (intColors.length > 3) {\n        intColors.length = 3;\n    }\n    else if (intColors.length < 3) {\n        return [0, 0, 0];\n    }\n    return intColors;\n}\nfunction parseColor(color) {\n    var result = [0, 0, 0];\n    if (typeof color === 'string') {\n        normalizeColor(color).forEach(function (color, idx) {\n            result[idx] = color / 255;\n        });\n    }\n    else if (Array.isArray(color) && color.length === 3) {\n        color.slice(0, 3).forEach(function (color, idx) {\n            result[idx] = color / 255;\n        });\n    }\n    return result;\n}\nvar Klouds = /** @class */ (function () {\n    function Klouds(options) {\n        var _this = this;\n        this.isRunning = false;\n        this.accumTime = 0;\n        this.lastTime = performance.now();\n        this.render = function (time) {\n            var gl = _this.gl;\n            var program = _this.program;\n            var buffer = _this.buffer;\n            var dt = (time - _this.lastTime) * _this.speed * 0.001;\n            _this.accumTime += dt;\n            _this.lastTime = time;\n            graphics_1.resizeCanvasToDisplaySize(_this.canvas);\n            gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\n            gl.useProgram(program.handle);\n            gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n            var posAttrib = program.attributes['position'];\n            gl.enableVertexAttribArray(posAttrib);\n            gl.vertexAttribPointer(posAttrib, 3, gl.FLOAT, false, 0, 0);\n            gl.uniform2f(program.uniforms['resolution'], gl.canvas.width, gl.canvas.height);\n            gl.uniform1f(program.uniforms['layerCount'], _this.layerCount);\n            gl.uniform1f(program.uniforms['time'], _this.accumTime);\n            gl.uniform3fv(program.uniforms['bgColor'], _this.bgColor);\n            gl.uniform3fv(program.uniforms['cloudColor1'], _this.cloudColor1);\n            gl.uniform3fv(program.uniforms['cloudColor2'], _this.cloudColor2);\n            gl.drawArrays(gl.TRIANGLES, 0, 6);\n            if (_this.isRunning) {\n                requestAnimationFrame(_this.render);\n            }\n        };\n        var canvas = this.queryRootElement(options.selector);\n        if (!canvas) {\n            throw new Error(\"Invalid options.selector value passed to Klouds\");\n        }\n        this.canvas = canvas;\n        var speed = options.speed || 1;\n        var layerCount = options.layerCount || 5;\n        var cloudColor1 = options.cloudColor1 || [25, 178, 204];\n        var cloudColor2 = options.cloudColor2 || [255, 255, 255];\n        var bgColor = options.bgColor || [0, 102, 128];\n        canvas.style.width = '100%';\n        canvas.style.height = '100%';\n        this.initGraphics(canvas);\n        this.setSpeed(speed);\n        this.setLayerCount(layerCount);\n        this.setBgColor(bgColor);\n        this.setCloudColor1(cloudColor1);\n        this.setCloudColor2(cloudColor2);\n        this.start();\n    }\n    Klouds.prototype.queryRootElement = function (selector) {\n        if (typeof selector === 'string') {\n            var element = document.querySelector(selector);\n            if (!element) {\n                console.error('options.selector element not found');\n                return null;\n            }\n            else if (!(element instanceof HTMLCanvasElement)) {\n                console.error('options.selector element is not a <canvas> element');\n                return null;\n            }\n            else {\n                return element;\n            }\n        }\n        else if (selector instanceof HTMLElement) {\n            if (selector instanceof HTMLCanvasElement) {\n                return selector;\n            }\n            else {\n                console.error('options.selector element is not a <canvas> element');\n                return null;\n            }\n        }\n        else {\n            console.error('options.selector value is invalid');\n            return null;\n        }\n    };\n    Klouds.prototype.initGraphics = function (canvas) {\n        var gl = graphics_1.createContext(canvas);\n        if (!gl) {\n            throw new Error('Failed to create WebGL context');\n        }\n        var program = graphics_1.createProgram(gl, shader_vert_1[\"default\"], shader_frag_1[\"default\"], ['position'], [\n            'resolution',\n            'layerCount',\n            'time',\n            'bgColor',\n            'cloudColor1',\n            'cloudColor2'\n        ]);\n        if (!program) {\n            throw new Error('Failed to create WebGL program');\n        }\n        var buffer = gl.createBuffer();\n        if (!buffer) {\n            gl.deleteProgram(program);\n            throw new Error('Failed to create WebGL buffer');\n        }\n        var posAttrib = program.attributes['position'];\n        gl.enableVertexAttribArray(posAttrib);\n        gl.vertexAttribPointer(posAttrib, 3, gl.FLOAT, false, 0, 0);\n        var bufferData = [\n            [-1, -1, 0],\n            [1, -1, 0],\n            [-1, 1, 0],\n            [-1, 1, 0],\n            [1, -1, 0],\n            [1, 1, 0]\n        ];\n        gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(bufferData.reduce(function (prev, cur) { return prev.concat(cur); }, [])), gl.STATIC_DRAW);\n        this.gl = gl;\n        this.program = program;\n        this.buffer = buffer;\n    };\n    Klouds.prototype.start = function () {\n        if (this.isRunning) {\n            return;\n        }\n        this.isRunning = true;\n        requestAnimationFrame(this.render);\n    };\n    Klouds.prototype.stop = function () {\n        this.isRunning = false;\n    };\n    Klouds.prototype.setSpeed = function (speed) {\n        this.speed = Math.max(-100, Math.min(100, speed));\n    };\n    Klouds.prototype.setCloudColor1 = function (color) {\n        var c = parseColor(color);\n        if (c) {\n            this.cloudColor1 = c;\n        }\n    };\n    Klouds.prototype.setCloudColor2 = function (color) {\n        var c = parseColor(color);\n        if (c) {\n            this.cloudColor2 = c;\n        }\n    };\n    Klouds.prototype.setBgColor = function (color) {\n        var c = parseColor(color);\n        if (c) {\n            this.bgColor = c;\n        }\n    };\n    Klouds.prototype.setLayerCount = function (count) {\n        this.layerCount = Math.max(1, Math.min(8, count)) / 10;\n    };\n    Klouds.prototype.getSpeed = function () {\n        return this.speed;\n    };\n    Klouds.prototype.getLayerCount = function () {\n        return this.layerCount;\n    };\n    Klouds.prototype.getBgColor = function () {\n        return this.bgColor.slice();\n    };\n    Klouds.prototype.getCloudColor1 = function () {\n        return this.cloudColor1.slice();\n    };\n    Klouds.prototype.getCloudColor2 = function () {\n        return this.cloudColor2.slice();\n    };\n    return Klouds;\n}());\nexports.Klouds = Klouds;\nfunction create(options) {\n    return new Klouds(options);\n}\nexports.create = create;\nif (window && typeof window.jQuery !== 'undefined') {\n    ;\n    window.jQuery.fn.Klouds = function (options) {\n        options = options || {};\n        var elements = this.get();\n        var skies = [];\n        for (var i = 0; i < elements.length; ++i) {\n            options.selector = elements[i];\n            skies.push(new Klouds(options));\n        }\n        return skies;\n    };\n}\n","export default \"attribute vec3 position;\\n\\nvoid main() {\\n    gl_Position = vec4(position, 1.0);\\n}\\n\";","export default \"precision mediump float;\\n\\nuniform vec2 resolution;\\nuniform float layerCount;\\nuniform float time;\\nuniform vec3 bgColor;\\nuniform vec3 cloudColor1;\\nuniform vec3 cloudColor2;\\n\\n#define TAU 6.28318530718\\n\\nfloat func(float pX) {\\n    return 0.6 * (0.5 * sin(0.1 * pX) + 0.5 * sin(0.553 * pX) + 0.7 * sin(1.2 * pX));\\n}\\n\\nfloat funcR(float pX) {\\n    return 0.5 + 0.25 * (1.0 + sin(mod(40.0 * pX, TAU)));\\n}\\n\\nfloat layer(vec2 pQ, float pT) {\\n    vec2 Qt = 3.5 * pQ;\\n    pT *= 0.5;\\n    Qt.x += pT;\\n\\n    float Xi = floor(Qt.x);\\n    float Xf = Qt.x - Xi - 0.5;\\n\\n    vec2 C;\\n    float Yi;\\n    float D = 1.0 - step(Qt.y,  func(Qt.x));\\n\\n    Yi = func(Xi + 0.5);\\n    C = vec2(Xf, Qt.y - Yi ); \\n    D =  min(D, length(C) - funcR(Xi + pT / 80.0));\\n\\n    Yi = func(Xi + 1.0 + 0.5);\\n    C = vec2(Xf - 1.0, Qt.y - Yi ); \\n    D =  min(D, length(C) - funcR(Xi + 1.0+ pT / 80.0));\\n\\n    Yi = func(Xi - 1.0 + 0.5);\\n    C = vec2(Xf + 1.0, Qt.y - Yi ); \\n    D =  min(D, length(C) - funcR(Xi - 1.0 + pT / 80.0));\\n\\n    return min(1.0, D);\\n}\\n\\nvoid main() {\\n    float t = time;\\n    vec2 UV = 2.0 * (gl_FragCoord.xy - resolution.xy / 2.0) / min(resolution.x, resolution.y);\\t\\n    \\n    vec3 Color = bgColor;\\n\\n    for(float i = 0.0; i < 0.8; i += 0.1) {\\n        if (i >= layerCount) {\\n            break;\\n        }\\n\\n        float Lt =  t * (0.5 + 2.0 * i) * (1.0 + 0.1 * sin(226.0 * i)) + 1000.0 * i;\\n        vec2 Lp = vec2(100.0 * i, 0.8 * (i / (layerCount - 0.0999) / 0.8) - 0.3);\\n        float L = layer(UV + Lp, Lt);\\n\\n        float Blur = 4.0 * (0.5 * abs(2.0 - 5.0 * i)) / (11.0 - 5.0 * i);\\n\\n        float V = mix(0.0, 1.0, 1.0 - smoothstep(0.0, 0.01 + 0.2 * Blur, L));\\n        vec3 Lc = mix(cloudColor1, cloudColor2, i / (layerCount - 0.0999) / 0.8);\\n\\n        Color = mix(Color, Lc,  V);\\n    }\\n\\n    gl_FragColor = vec4(Color, 1.0);\\n}\\n\";","\"use strict\";\nexports.__esModule = true;\nexports.resizeCanvasToDisplaySize = exports.createProgram = exports.createShader = exports.ShaderType = exports.createContext = void 0;\nfunction createContext(canvas) {\n    return canvas.getContext('webgl');\n}\nexports.createContext = createContext;\nvar ShaderType;\n(function (ShaderType) {\n    ShaderType[ShaderType[\"VERTEX\"] = 0] = \"VERTEX\";\n    ShaderType[ShaderType[\"FRAGMENT\"] = 1] = \"FRAGMENT\";\n})(ShaderType = exports.ShaderType || (exports.ShaderType = {}));\nfunction createShader(gl, type, source) {\n    var shader = type === ShaderType.VERTEX\n        ? gl.createShader(gl.VERTEX_SHADER)\n        : gl.createShader(gl.FRAGMENT_SHADER);\n    if (!shader) {\n        console.error('Failed to create WebGL shader');\n        return null;\n    }\n    gl.shaderSource(shader, source);\n    gl.compileShader(shader);\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n        console.debug(gl.getShaderInfoLog(shader));\n        console.error('Failed to compile WebGL shader');\n        gl.deleteShader(shader);\n        return null;\n    }\n    return shader;\n}\nexports.createShader = createShader;\nfunction createProgram(gl, vertShaderSrc, fragShaderSrc, attributeNames, uniformNames) {\n    var program = gl.createProgram();\n    if (!program) {\n        console.error('Failed to create WebGL program');\n        return null;\n    }\n    var vertexShader = createShader(gl, ShaderType.VERTEX, vertShaderSrc);\n    var fragmentShader = createShader(gl, ShaderType.FRAGMENT, fragShaderSrc);\n    if (!vertexShader || !fragmentShader) {\n        console.error('Failed to create a shader while creating a program');\n        return null;\n    }\n    gl.attachShader(program, vertexShader);\n    gl.attachShader(program, fragmentShader);\n    gl.linkProgram(program);\n    gl.validateProgram(program);\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n        gl.deleteProgram(program);\n        gl.deleteShader(vertexShader);\n        gl.deleteShader(fragmentShader);\n        console.error(\"Failed to link WebGL program\");\n        console.debug(gl.getProgramInfoLog(program));\n        return null;\n    }\n    if (!gl.getProgramParameter(program, gl.VALIDATE_STATUS)) {\n        gl.deleteProgram(program);\n        gl.deleteShader(vertexShader);\n        gl.deleteShader(fragmentShader);\n        console.error(\"Failed to validate WebGL program\");\n        console.debug(gl.getProgramInfoLog(program));\n        return null;\n    }\n    var attributes = {};\n    for (var i = 0; i < attributeNames.length; ++i) {\n        var name_1 = attributeNames[i];\n        var attr = gl.getAttribLocation(program, name_1);\n        if (attr === -1) {\n            console.error(\"Program attribute named \\\"\" + name_1 + \"\\\" doesn't exist\");\n            gl.deleteProgram(program);\n            return null;\n        }\n        attributes[name_1] = attr;\n    }\n    var uniforms = {};\n    for (var i = 0; i < uniformNames.length; ++i) {\n        var name_2 = uniformNames[i];\n        var uniform = gl.getUniformLocation(program, name_2);\n        if (uniform === null) {\n            console.error(\"Program uniform named \\\"\" + name_2 + \"\\\" doesn't exist\");\n            gl.deleteProgram(program);\n            return null;\n        }\n        uniforms[name_2] = uniform;\n    }\n    return {\n        handle: program,\n        attributes: attributes,\n        uniforms: uniforms\n    };\n}\nexports.createProgram = createProgram;\nfunction resizeCanvasToDisplaySize(canvas) {\n    var width = canvas.clientWidth;\n    var height = canvas.clientHeight;\n    if (canvas.width !== width || canvas.height !== height) {\n        canvas.width = width;\n        canvas.height = height;\n        return true;\n    }\n    return false;\n}\nexports.resizeCanvasToDisplaySize = resizeCanvasToDisplaySize;\n"],"sourceRoot":""}